Name:Maintenance Hangar
ManaCost:2 W
Types:Enchantment

T:Mode$ Phase | Phase$ Upkeep | ValidPlayer$ You | TriggerZones$ Battlefield | Execute$ TrigRemove | TriggerDescription$ At the beginning of your upkeep, remove an additional repair counter from each card in your graveyard.
SVar:TrigRemove:DB$ RemoveCounterAll | CounterType$ REPAIR | CounterNum$ 1 | ValidCards$ Card.Starship+YouOwn | ValidZone$ Graveyard

S:Mode$ Continuous | EffectZone$ Battlefield | AffectedZone$ Battlefield,Graveyard | Affected$ Creature.Starship+YouCtrl,Card.Starship | AddTrigger$ OnDeath | AddSVar$ TrigRepair
S:Mode$ Continuous | EffectZone$ Battlefield | AffectedZone$ Battlefield,Graveyard | Affected$ Creature.Starship+YouCtrl,Card.Starship | AddTrigger$ RepairUpkeep | AddSVar$ RepairCount
S:Mode$ Continuous | EffectZone$ Battlefield | AffectedZone$ Battlefield,Graveyard | Affected$ Creature.Starship+YouCtrl,Card.Starship | AddTrigger$ RepairFinal | AddSVar$ DBRepairRemove
S:Mode$ Continuous | EffectZone$ Battlefield | AffectedZone$ Battlefield,Graveyard | Affected$ Creature.Starship+YouCtrl,Card.Starship | AddSVar$ DBRepairCast
S:Mode$ Continuous | EffectZone$ Battlefield | AffectedZone$ Battlefield,Graveyard | Affected$ Creature.Starship+YouCtrl,Card.Starship | AddSVar$ STRepairCast

SVar:OnDeath:Mode$ ChangesZone | Origin$ Battlefield | Destination$ Graveyard | ValidCard$ Card.Self | Execute$ TrigRepair | TriggerDescription$ When CARDNAME dies, put six repair counters on it.
SVar:TrigRepair:DB$ PutCounter | CounterType$ REPAIR | CounterNum$ 6 | Defined$ TriggeredCard

SVar:RepairUpkeep:Mode$ Phase | Phase$ Upkeep | ValidPlayer$ You | ValidCard$ Card.Self+inGraveyard | CheckSVar$ RepairCount | SVarCompare$ GE1 | Execute$ DBRepairRemove | TriggerDescription$ At the beginning of your upkeep, if CARDNAME is in your graveyard with repair counters, remove a repair counter.
SVar:DBRepairRemove:DB$ RemoveCounter | CounterType$ REPAIR | CounterNum$ 1 | Defined$ Self

SVar:RepairCount:Count$CardCounters.REPAIR


SVar:RepairFinal:Mode$ CounterRemoved | TriggerZones$ Graveyard | ValidCard$ Card.Self | CounterType$ REPAIR | NewCounterAmount$ 0 | Execute$ DBRepairCast | TriggerDescription$ When the last repair counter is removed, you may cast CARDNAME until end of turn.

SVar:DBRepairCast:DB$ Effect | StaticAbilities$ STRepairCast | ForgetOnMoved$ Graveyard | RememberObjects$ Self | Duration$ EndOfTurn
SVar:STRepairCast:Mode$ Continuous | MayPlay$ True | Affected$ Card.IsRemembered | AffectedZone$ Graveyard | Description$ Until end of turn, you may play EFFECTSOURCE.

Oracle:At the beginning of your upkeep, remove an additional repair counter from each card in your graveyard.\nStarship creatures you control and starship creature cards in your graveyard have Repair 6. (When this creature dies, you may put six repair counters on it. At the beginning of your upkeep, remove a repair counter. Whenever the last is removed, you may cast it from your graveyard until end of turn.)
